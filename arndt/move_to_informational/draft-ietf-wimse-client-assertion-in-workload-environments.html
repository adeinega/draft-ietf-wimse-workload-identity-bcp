<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OAuth 2.0 Client Assertion in Workload Environments</title>
<meta content="Benedikt Hofmann" name="author">
<meta content="Hannes Tschofenig" name="author">
<meta content="Edoardo Giordano" name="author">
<meta content="Yaroslav Rosomakho" name="author">
<meta content="Arndt Schwenkschuster" name="author">
<meta content="
       The use of the OAuth 2.0 framework for container orchestration systems poses a challenge as managing secrets, such as client_id and client_secret, can be complex and error-prone. Instead of manual provisioning these credentials the industry has moved to a federation-based approach where credentials of the underlying workload platform are used as assertions towards an OAuth authorization server leveraging the Client Assertion Flow  , in particular  . 
       This approach is seen in the industry across many workload environments, this document outlines common patterns and their use cases. 
    " name="description">
<meta content="xml2rfc 3.23.2" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-wimse-client-assertion-in-workload-environments-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.23.2
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-wimse-client-assertion-in-workload-environments.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Workload Identity</td>
<td class="right">October 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hofmann, et al.</td>
<td class="center">Expires 21 April 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">WIMSE</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-wimse-client-assertion-in-workload-environments-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-10-18" class="published">18 October 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-04-21">21 April 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">B. Hofmann</div>
<div class="org">Siemens</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
<div class="org">Siemens</div>
</div>
<div class="author">
      <div class="author-name">E. Giordano</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">Y. Rosomakho</div>
<div class="org">Zscaler</div>
</div>
<div class="author">
      <div class="author-name">A. Schwenkschuster</div>
<div class="org">Microsoft</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OAuth 2.0 Client Assertion in Workload Environments</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The use of the OAuth 2.0 framework for container orchestration systems poses a challenge as managing secrets, such as client_id and client_secret, can be complex and error-prone. Instead of manual provisioning these credentials the industry has moved to a federation-based approach where credentials of the underlying workload platform are used as assertions towards an OAuth authorization server leveraging the Client Assertion Flow <span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span>, in particular <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This approach is seen in the industry across many workload environments, this document outlines common patterns and their use cases.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 April 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-patterns" class="internal xref">Patterns</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-kubernetes" class="internal xref">Kubernetes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-secure-production-identity-" class="internal xref">Secure Production Identity Framework For Everyone (SPIFFE)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-cloud-providers" class="internal xref">Cloud Providers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-continues-integration-deplo" class="internal xref">Continues integration/deployment systems</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Workloads often require access to external resources to perform their tasks. For example, access to a database, a web server or another workload. These resources are protected by an authorization server and can only be accessed with an access token. The challenge for workloads is to get this access token issued.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Traditionally, workloads can be provisioned with client secrets credentials and use the client_credential flow to retrieve an access token. This model comes with a set of challenges that make it insecure and high-maintaince. Client secrets need to be manually provisioned and rotated. They can be stolen and used by attackers to impersonate the workload.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">A solution to this problem is to not provision secret material to the workload itself but use the workload platform to attest for that workload. Many workload platforms offer a credential, in most cases a JWT token. Signed by a platform-internal authorization server, this credential attests the workload and its attributes. Based on <span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span> and its JWT profile <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>, this credential can then be used as a client assertion towards a different authorization server. <a href="#fig-overview" class="auto internal xref">Figure 1</a> illustrates this interaction.<a href="#section-1-3" class="pilcrow">¶</a></p>
<span id="name-oauth2-assertion-flow-in-ge"></span><div id="fig-overview">
<figure id="figure-1">
        <div id="section-1-4.1">
          <div class="alignLeft art-svg artwork" id="section-1-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="448" width="488" viewBox="0 0 488 448" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,176" fill="none" stroke="black"></path>
              <path d="M 8,272 L 8,432" fill="none" stroke="black"></path>
              <path d="M 24,80 L 24,144" fill="none" stroke="black"></path>
              <path d="M 32,320 L 32,384" fill="none" stroke="black"></path>
              <path d="M 128,144 L 128,192" fill="none" stroke="black"></path>
              <path d="M 128,224 L 128,320" fill="none" stroke="black"></path>
              <path d="M 176,240 L 176,320" fill="none" stroke="black"></path>
              <path d="M 208,320 L 208,384" fill="none" stroke="black"></path>
              <path d="M 232,80 L 232,144" fill="none" stroke="black"></path>
              <path d="M 280,80 L 280,144" fill="none" stroke="black"></path>
              <path d="M 304,320 L 304,336" fill="none" stroke="black"></path>
              <path d="M 304,368 L 304,384" fill="none" stroke="black"></path>
              <path d="M 384,144 L 384,192" fill="none" stroke="black"></path>
              <path d="M 384,224 L 384,240" fill="none" stroke="black"></path>
              <path d="M 448,80 L 448,144" fill="none" stroke="black"></path>
              <path d="M 456,320 L 456,384" fill="none" stroke="black"></path>
              <path d="M 480,32 L 480,176" fill="none" stroke="black"></path>
              <path d="M 480,272 L 480,432" fill="none" stroke="black"></path>
              <path d="M 8,32 L 480,32" fill="none" stroke="black"></path>
              <path d="M 24,80 L 232,80" fill="none" stroke="black"></path>
              <path d="M 280,80 L 448,80" fill="none" stroke="black"></path>
              <path d="M 24,144 L 120,144" fill="none" stroke="black"></path>
              <path d="M 136,144 L 232,144" fill="none" stroke="black"></path>
              <path d="M 280,144 L 376,144" fill="none" stroke="black"></path>
              <path d="M 392,144 L 448,144" fill="none" stroke="black"></path>
              <path d="M 8,176 L 480,176" fill="none" stroke="black"></path>
              <path d="M 176,240 L 384,240" fill="none" stroke="black"></path>
              <path d="M 8,272 L 480,272" fill="none" stroke="black"></path>
              <path d="M 32,320 L 208,320" fill="none" stroke="black"></path>
              <path d="M 304,320 L 456,320" fill="none" stroke="black"></path>
              <path d="M 208,352 L 304,352" fill="none" stroke="black"></path>
              <path d="M 32,384 L 208,384" fill="none" stroke="black"></path>
              <path d="M 304,384 L 456,384" fill="none" stroke="black"></path>
              <path d="M 8,432 L 480,432" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="392,144 380,138.4 380,149.6" fill="black" transform="rotate(270,384,144)"></polygon>
              <polygon class="arrowhead" points="312,352 300,346.4 300,357.6" fill="black" transform="rotate(0,304,352)"></polygon>
              <polygon class="arrowhead" points="136,144 124,138.4 124,149.6" fill="black" transform="rotate(270,128,144)"></polygon>
              <g class="text">
                <text x="260" y="52">External</text>
                <text x="352" y="52">Authorization</text>
                <text x="436" y="52">Domain</text>
                <text x="104" y="116">Authorization</text>
                <text x="188" y="116">Server</text>
                <text x="328" y="116">Protected</text>
                <text x="404" y="116">Resource</text>
                <text x="52" y="212">2)</text>
                <text x="96" y="212">present</text>
                <text x="168" y="212">assertion</text>
                <text x="348" y="212">3)</text>
                <text x="388" y="212">access</text>
                <text x="356" y="292">Workload</text>
                <text x="428" y="292">Platform</text>
                <text x="356" y="340">Credential</text>
                <text x="84" y="356">Workload</text>
                <text x="340" y="356">issued</text>
                <text x="380" y="356">by</text>
                <text x="236" y="372">1)</text>
                <text x="264" y="372">get</text>
                <text x="348" y="372">Platform</text>
              </g>
            </svg><a href="#section-1-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-oauth2-assertion-flow-in-ge" class="selfRef">OAuth2 Assertion Flow in generic Workload Environment</a>
        </figcaption></figure>
</div>
<p id="section-1-5">The figure outlines the following steps which are applicable in any pattern.<a href="#section-1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">
          <p id="section-1-6.1.1">1) retrieve credential issued by platform. The way this is acchieved and whether this is workload or platform initiated differs based on the platform.<a href="#section-1-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-6.2">
          <p id="section-1-6.2.1">2) present credential as an assertion towards an authorization server in an external authorization domain. This step uses the assertion_grant flow defined in <span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span> and, in case of JWT format, <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>. As a result of this flow, an access token is returned to the workload.<a href="#section-1-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-6.3">
          <p id="section-1-6.3.1">3) use access token from the previous step to access a protected resource in the external authorization domain.<a href="#section-1-6.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-7">This specifiation defines this flow in more detail based on common pattern seen in the industry and gives reccomendations.<a href="#section-1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in
BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all
capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The terms 'workload' and 'container' are used interchangeably.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="patterns">
<section id="section-3">
      <h2 id="name-patterns">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-patterns" class="section-name selfRef">Patterns</a>
      </h2>
<div id="kubernetes">
<section id="section-3.1">
        <h3 id="name-kubernetes">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-kubernetes" class="section-name selfRef">Kubernetes</a>
        </h3>
<p id="section-3.1-1">In Kubernetes, the primary concept of machine identity is implemented through "service accounts" <span>[<a href="#KubernetesServiceAccount" class="cite xref">KubernetesServiceAccount</a>]</span>. These accounts can be explicitly created or a default one is automatically assigned. Service accounts utilize JSON Web Tokens (JWTs) <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> as their credential format, with these tokens being cryptographically signed by the Kubernetes Control Plane.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Service accounts serve multiple authentication purposes within the Kubernetes ecosystem. They are used to authenticate to Kubernetes APIs, between different workloads and to access external resources (which is particularly relevant to the scope of this document).<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">To programatically use service accounts, workloads can:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.1">
            <p id="section-3.1-4.1.1">use the Token Request API <span>[<a href="#TokenReviewV1" class="cite xref">TokenReviewV1</a>]</span> of the control plane<a href="#section-3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.2">
            <p id="section-3.1-4.2.1">have the token projected into the file system of the workload. This is commonly referred to as "projected service accout token".<a href="#section-3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-5">Both options allow workloads to:<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-6.1">
            <p id="section-3.1-6.1.1">specify a custom audience. Possible audiences can be restricted based on policy.<a href="#section-3.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-6.2">
            <p id="section-3.1-6.2.1">specify a custom lifetime. Maximum lifetime can be restricted by policy.<a href="#section-3.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-6.3">
            <p id="section-3.1-6.3.1">bind the token lifetime to an object lifecycle. This allows the token to be invalidated when the object is deleted. For example, when a Kubernetes Deployment is removed from the server. It is important to highlight, that invalidation is only in effect if the Token Review API <span>[<a href="#TokenReviewV1" class="cite xref">TokenReviewV1</a>]</span> of Kubernetes is used to validate the token.<a href="#section-3.1-6.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-7">To validate service account tokens, Kubernetes offers workloads to:<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-8.1">
            <p id="section-3.1-8.1.1">make us of the Token Review API <span>[<a href="#TokenReviewV1" class="cite xref">TokenReviewV1</a>]</span>. This API introspects the token, makes sure it hasn't been invalidated and returns the claims.<a href="#section-3.1-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-8.2">
            <p id="section-3.1-8.2.1">mount the public keys used to sign the tokens into the file system of the workload. This allows workloads to decentrally validate the tokens signature.<a href="#section-3.1-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-8.3">
            <p id="section-3.1-8.3.1">Optionally, a JSON Web Key Set <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span> is exposed via a webserver. This allows the Service Account Token to be validated outside of the cluster and without line of sight towards the actual Kubernetes Control Plane API.<a href="#section-3.1-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-oauth2-assertion-flow-in-a-"></span><div id="fig-kubernetes">
<figure id="figure-2">
          <div id="section-3.1-9.1">
            <div class="alignLeft art-svg artwork" id="section-3.1-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="560" width="464" viewBox="0 0 464 560" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,176" fill="none" stroke="black"></path>
                <path d="M 8,240 L 8,544" fill="none" stroke="black"></path>
                <path d="M 24,80 L 24,144" fill="none" stroke="black"></path>
                <path d="M 40,448 L 40,512" fill="none" stroke="black"></path>
                <path d="M 48,288 L 48,352" fill="none" stroke="black"></path>
                <path d="M 88,352 L 88,384" fill="none" stroke="black"></path>
                <path d="M 88,416 L 88,448" fill="none" stroke="black"></path>
                <path d="M 128,144 L 128,192" fill="none" stroke="black"></path>
                <path d="M 128,224 L 128,288" fill="none" stroke="black"></path>
                <path d="M 224,352 L 224,384" fill="none" stroke="black"></path>
                <path d="M 224,432 L 224,448" fill="none" stroke="black"></path>
                <path d="M 240,80 L 240,144" fill="none" stroke="black"></path>
                <path d="M 240,256 L 240,288" fill="none" stroke="black"></path>
                <path d="M 256,80 L 256,144" fill="none" stroke="black"></path>
                <path d="M 280,288 L 280,352" fill="none" stroke="black"></path>
                <path d="M 344,144 L 344,192" fill="none" stroke="black"></path>
                <path d="M 344,224 L 344,256" fill="none" stroke="black"></path>
                <path d="M 384,448 L 384,512" fill="none" stroke="black"></path>
                <path d="M 424,80 L 424,144" fill="none" stroke="black"></path>
                <path d="M 456,32 L 456,176" fill="none" stroke="black"></path>
                <path d="M 456,240 L 456,544" fill="none" stroke="black"></path>
                <path d="M 8,32 L 456,32" fill="none" stroke="black"></path>
                <path d="M 24,80 L 240,80" fill="none" stroke="black"></path>
                <path d="M 256,80 L 424,80" fill="none" stroke="black"></path>
                <path d="M 24,144 L 120,144" fill="none" stroke="black"></path>
                <path d="M 136,144 L 240,144" fill="none" stroke="black"></path>
                <path d="M 256,144 L 336,144" fill="none" stroke="black"></path>
                <path d="M 352,144 L 424,144" fill="none" stroke="black"></path>
                <path d="M 8,176 L 456,176" fill="none" stroke="black"></path>
                <path d="M 8,240 L 456,240" fill="none" stroke="black"></path>
                <path d="M 240,256 L 344,256" fill="none" stroke="black"></path>
                <path d="M 48,288 L 280,288" fill="none" stroke="black"></path>
                <path d="M 48,352 L 80,352" fill="none" stroke="black"></path>
                <path d="M 96,352 L 216,352" fill="none" stroke="black"></path>
                <path d="M 232,352 L 280,352" fill="none" stroke="black"></path>
                <path d="M 40,448 L 384,448" fill="none" stroke="black"></path>
                <path d="M 40,512 L 384,512" fill="none" stroke="black"></path>
                <path d="M 8,544 L 456,544" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="352,144 340,138.4 340,149.6" fill="black" transform="rotate(270,344,144)"></polygon>
                <polygon class="arrowhead" points="232,352 220,346.4 220,357.6" fill="black" transform="rotate(270,224,352)"></polygon>
                <polygon class="arrowhead" points="136,144 124,138.4 124,149.6" fill="black" transform="rotate(270,128,144)"></polygon>
                <polygon class="arrowhead" points="96,352 84,346.4 84,357.6" fill="black" transform="rotate(270,88,352)"></polygon>
                <g class="text">
                  <text x="244" y="52">External</text>
                  <text x="336" y="52">Authorization</text>
                  <text x="420" y="52">Domain</text>
                  <text x="104" y="116">Authorization</text>
                  <text x="188" y="116">Server</text>
                  <text x="304" y="116">Protected</text>
                  <text x="380" y="116">Resource</text>
                  <text x="60" y="212">3)</text>
                  <text x="104" y="212">present</text>
                  <text x="176" y="212">assertion</text>
                  <text x="316" y="212">4)</text>
                  <text x="356" y="212">access</text>
                  <text x="404" y="260">Kubernetes</text>
                  <text x="416" y="276">Cluster</text>
                  <text x="116" y="324">Workload</text>
                  <text x="52" y="404">1)</text>
                  <text x="100" y="404">schedule</text>
                  <text x="180" y="404">2)</text>
                  <text x="224" y="404">project</text>
                  <text x="288" y="404">service</text>
                  <text x="224" y="420">account</text>
                  <text x="280" y="420">token</text>
                  <text x="148" y="484">Kubernetes</text>
                  <text x="224" y="484">Control</text>
                  <text x="280" y="484">Plane</text>
                </g>
              </svg><a href="#section-3.1-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-oauth2-assertion-flow-in-a-" class="selfRef">OAuth2 Assertion Flow in a Kubernetes Workload Environment</a>
          </figcaption></figure>
</div>
<p id="section-3.1-10">The steps shown in <a href="#fig-kubernetes" class="auto internal xref">Figure 2</a> are:<a href="#section-3.1-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-11.1">
            <p id="section-3.1-11.1.1">1) The Kubernetes Control Plane schedules the workload. This is much simplified and technically happens asynchronously.<a href="#section-3.1-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-11.2">
            <p id="section-3.1-11.2.1">2) The Kubernetes Control Plane projects the service account token into the workload. This step is also much simplified and technically happens alongside the scheduling with step 1.<a href="#section-3.1-11.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-11.3">
            <p id="section-3.1-11.3.1">3) Workloads present the project service account token as a client assertion towards an external authorization server according to <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>. An access token is returned to the workload as a result.<a href="#section-3.1-11.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-11.4">
            <p id="section-3.1-11.4.1">4) The access token issued by the external authorization server is used by the workload to access the projected resource.<a href="#section-3.1-11.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-12">As an example, the following JSON showcases the claims a Kubernetes Service Account token carries.<a href="#section-3.1-12" class="pilcrow">¶</a></p>
<span id="name-example-kubernetes-service-"></span><div id="fig-kubernetes-token">
<figure id="figure-3">
          <div class="lang-json sourcecode" id="section-3.1-13.1">
<pre>
{
  "aud": [  # matches the requested audiences, or the API server's default audiences when none are explicitly requested
    "https://kubernetes.default.svc"
  ],
  "exp": 1731613413,
  "iat": 1700077413,
  "iss": "https://kubernetes.default.svc",  # matches the first value passed to the --service-account-issuer flag
  "jti": "ea28ed49-2e11-4280-9ec5-bc3d1d84661a",  # ServiceAccountTokenJTI feature must be enabled for the claim to be present
  "kubernetes.io": {
    "namespace": "my-namespace",
    "node": {  # ServiceAccountTokenPodNodeInfo feature must be enabled for the API server to add this node reference claim
      "name": "127.0.0.1",
      "uid": "58456cb0-dd00-45ed-b797-5578fdceaced"
    },
    "pod": {
      "name": "my-workload-69cbfb9798-jv9gn",
      "uid": "778a530c-b3f4-47c0-9cd5-ab018fb64f33"
    },
    "serviceaccount": {
      "name": "my-workload",
      "uid": "a087d5a0-e1dd-43ec-93ac-f13d89cd13af"
    },
    "warnafter": 1700081020
  },
  "nbf": 1700077413,
  "sub": "system:serviceaccount:my-namespace:my-workload"
}
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-example-kubernetes-service-" class="selfRef">Example Kubernetes Service Account Token claims</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="spiffe">
<section id="section-3.2">
        <h3 id="name-secure-production-identity-">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-secure-production-identity-" class="section-name selfRef">Secure Production Identity Framework For Everyone (SPIFFE)</a>
        </h3>
<p id="section-3.2-1">Secure Production Identity Framework For Everyone, also known as SPIFFE, is a cloud native compute foundation (CNCF) adopted project which defines an API definitioned called "Workload API" to delivery machine identity to workloads. Workloads can retrieve either X509 based or JWT credentials without the need to authenticate making it very easy to use. How workloads authenticate on the API is not part of the specification. It is common to use platform metadata from the operating system and the workload platform for authentication on the Workload API.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">For the scope of this document, the JWT formatted credential is the most relevant one. SPIFFE referres to it as "JWT-SVID" (JWT - Single Verifyable Identity Document).<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Workloads are required to specify at least one audience when requesting a JWT-SVID from the Workload API.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">To allow validation, SPIFFE offers<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-5.1">
            <p id="section-3.2-5.1.1">to download a set JWK encoded public keys that can be used to validate JWT signatures. In SPIFFE this is referred to as the "JWT trust bundle".<a href="#section-3.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-5.2">
            <p id="section-3.2-5.2.1">invoke a validation method on the Workload API to validate JWT-SVIDs<a href="#section-3.2-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-6">Additionally, many SPIFFE deployments choose to separately publish the signing keys as a JSON Web Key Set on a web server to allow validation where the Workload API is not available.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">The following figure illustrates how a workload can use its JWT-SVID to access a protected resource outside of SPIFFE.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<span id="name-oauth2-assertion-flow-in-a-s"></span><div id="fig-spiffe">
<figure id="figure-4">
          <div id="section-3.2-8.1">
            <div class="alignLeft art-svg artwork" id="section-3.2-8.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="480" width="480" viewBox="0 0 480 480" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,160" fill="none" stroke="black"></path>
                <path d="M 8,224 L 8,464" fill="none" stroke="black"></path>
                <path d="M 32,256 L 32,320" fill="none" stroke="black"></path>
                <path d="M 32,384 L 32,448" fill="none" stroke="black"></path>
                <path d="M 40,64 L 40,128" fill="none" stroke="black"></path>
                <path d="M 128,128 L 128,176" fill="none" stroke="black"></path>
                <path d="M 128,208 L 128,256" fill="none" stroke="black"></path>
                <path d="M 208,320 L 208,336" fill="none" stroke="black"></path>
                <path d="M 208,368 L 208,384" fill="none" stroke="black"></path>
                <path d="M 232,64 L 232,128" fill="none" stroke="black"></path>
                <path d="M 264,64 L 264,128" fill="none" stroke="black"></path>
                <path d="M 336,128 L 336,176" fill="none" stroke="black"></path>
                <path d="M 336,208 L 336,256" fill="none" stroke="black"></path>
                <path d="M 376,256 L 376,320" fill="none" stroke="black"></path>
                <path d="M 376,384 L 376,448" fill="none" stroke="black"></path>
                <path d="M 448,64 L 448,128" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,160" fill="none" stroke="black"></path>
                <path d="M 472,224 L 472,464" fill="none" stroke="black"></path>
                <path d="M 8,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 40,64 L 232,64" fill="none" stroke="black"></path>
                <path d="M 264,64 L 448,64" fill="none" stroke="black"></path>
                <path d="M 40,128 L 120,128" fill="none" stroke="black"></path>
                <path d="M 136,128 L 232,128" fill="none" stroke="black"></path>
                <path d="M 264,128 L 328,128" fill="none" stroke="black"></path>
                <path d="M 344,128 L 448,128" fill="none" stroke="black"></path>
                <path d="M 8,160 L 472,160" fill="none" stroke="black"></path>
                <path d="M 8,224 L 472,224" fill="none" stroke="black"></path>
                <path d="M 32,256 L 376,256" fill="none" stroke="black"></path>
                <path d="M 32,320 L 376,320" fill="none" stroke="black"></path>
                <path d="M 32,384 L 200,384" fill="none" stroke="black"></path>
                <path d="M 216,384 L 376,384" fill="none" stroke="black"></path>
                <path d="M 32,448 L 376,448" fill="none" stroke="black"></path>
                <path d="M 8,464 L 472,464" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="344,128 332,122.4 332,133.6" fill="black" transform="rotate(270,336,128)"></polygon>
                <polygon class="arrowhead" points="216,384 204,378.4 204,389.6" fill="black" transform="rotate(90,208,384)"></polygon>
                <polygon class="arrowhead" points="136,128 124,122.4 124,133.6" fill="black" transform="rotate(270,128,128)"></polygon>
                <g class="text">
                  <text x="260" y="52">External</text>
                  <text x="352" y="52">Authorization</text>
                  <text x="436" y="52">Domain</text>
                  <text x="104" y="100">Authorization</text>
                  <text x="188" y="100">Server</text>
                  <text x="320" y="100">Protected</text>
                  <text x="396" y="100">Resource</text>
                  <text x="60" y="196">2)</text>
                  <text x="104" y="196">present</text>
                  <text x="176" y="196">assertion</text>
                  <text x="308" y="196">3)</text>
                  <text x="348" y="196">access</text>
                  <text x="428" y="244">Workload</text>
                  <text x="428" y="260">Platform</text>
                  <text x="212" y="292">Workload</text>
                  <text x="156" y="356">1)</text>
                  <text x="184" y="356">get</text>
                  <text x="236" y="356">JWT-SVID</text>
                  <text x="148" y="420">SPIFFE</text>
                  <text x="212" y="420">Workload</text>
                  <text x="264" y="420">API</text>
                </g>
              </svg><a href="#section-3.2-8.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-oauth2-assertion-flow-in-a-s" class="selfRef">OAuth2 Assertion Flow in a SPIFFE Environment</a>
          </figcaption></figure>
</div>
<p id="section-3.2-9">The steps shown in <a href="#fig-spiffe" class="auto internal xref">Figure 4</a> are:<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-10.1">
            <p id="section-3.2-10.1.1">1) The workload retrieves JWT-SVID from the SPIFFE Workload API.<a href="#section-3.2-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-10.2">
            <p id="section-3.2-10.2.1">2) The workload presents the JWT-SVID as a client assertion in the assertion flow based on <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>. An access token is returned to the workload.<a href="#section-3.2-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-10.3">
            <p id="section-3.2-10.3.1">3) The access token returned in the previous step is used by the workload to access a protected resource.<a href="#section-3.2-10.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-11">The claims of a JWT-SVID for example looks like this.<a href="#section-3.2-11" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-3.2-12">
<pre>
{
  "aud": [
    "my-audience"
  ],
  "exp": 1729087175,
  "iat": 1729086875,
  "sub": "spiffe://example.org/myservice"
}
</pre><a href="#section-3.2-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cloudproviders">
<section id="section-3.3">
        <h3 id="name-cloud-providers">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-cloud-providers" class="section-name selfRef">Cloud Providers</a>
        </h3>
<p id="section-3.3-1">Workload in cloud platforms can have any shape or form. Historically, virtual machines were the most common, with the introduction of containerization, hosted container environment or Kubernetes clusters were introduced, and lately, <code>serverless</code> functions are offered. Regardless of the actual workload packaging, distribution and runtime platform, all are in need of identity.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">To create a common identity interface across cloud services and offerings, the pattern of an <code>Instance Metadata Endpoint</code> has been established by the biggest cloud providers. Next to the option for workloads to get metadata about themselves, it also allows them to receive identity. The credential types offered can vary. JWT, however, is the one that is common across all of them. The issued credential allows proof to anyone it is being presented to, that the workload platform has attested the workload and it can be considered authenticated.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">Within a cloud provider the issued credential can often directly be used to access resources of any kind across the platform making integration between the services easy and <code>credential less</code>. While the term is technically missleading, from a user perspective, no credential needs to be issued, provisioned, rotated or revoked, as everything is handled internally by the platform.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">Resources outside of the platform, for example resources or workloads in other clouds, generic web servers or on-premise resources, are most of the time, however, protected by different domains and authorization servers and deny the platform issued credential. In this scenario, the pattern of using the platform issued credential as an assertion in the context of <span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span>, for JWT particularly <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span> towards the authorization server that protected the resource to get an access token.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<span id="name-oauth2-assertion-flow-in-a-c"></span><div id="fig-cloud">
<figure id="figure-5">
          <div id="section-3.3-5.1">
            <div class="alignLeft art-svg artwork" id="section-3.3-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="544" width="432" viewBox="0 0 432 544" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,176" fill="none" stroke="black"></path>
                <path d="M 8,272 L 8,528" fill="none" stroke="black"></path>
                <path d="M 24,80 L 24,144" fill="none" stroke="black"></path>
                <path d="M 40,320 L 40,384" fill="none" stroke="black"></path>
                <path d="M 40,448 L 40,512" fill="none" stroke="black"></path>
                <path d="M 120,144 L 120,208" fill="none" stroke="black"></path>
                <path d="M 120,240 L 120,320" fill="none" stroke="black"></path>
                <path d="M 120,384 L 120,400" fill="none" stroke="black"></path>
                <path d="M 120,432 L 120,448" fill="none" stroke="black"></path>
                <path d="M 160,256 L 160,320" fill="none" stroke="black"></path>
                <path d="M 192,320 L 192,384" fill="none" stroke="black"></path>
                <path d="M 208,80 L 208,144" fill="none" stroke="black"></path>
                <path d="M 224,448 L 224,512" fill="none" stroke="black"></path>
                <path d="M 232,80 L 232,144" fill="none" stroke="black"></path>
                <path d="M 320,144 L 320,208" fill="none" stroke="black"></path>
                <path d="M 320,240 L 320,256" fill="none" stroke="black"></path>
                <path d="M 320,320 L 320,336" fill="none" stroke="black"></path>
                <path d="M 320,368 L 320,464" fill="none" stroke="black"></path>
                <path d="M 408,80 L 408,144" fill="none" stroke="black"></path>
                <path d="M 408,320 L 408,464" fill="none" stroke="black"></path>
                <path d="M 424,32 L 424,176" fill="none" stroke="black"></path>
                <path d="M 424,272 L 424,528" fill="none" stroke="black"></path>
                <path d="M 8,32 L 424,32" fill="none" stroke="black"></path>
                <path d="M 24,80 L 208,80" fill="none" stroke="black"></path>
                <path d="M 232,80 L 408,80" fill="none" stroke="black"></path>
                <path d="M 24,144 L 112,144" fill="none" stroke="black"></path>
                <path d="M 128,144 L 208,144" fill="none" stroke="black"></path>
                <path d="M 232,144 L 312,144" fill="none" stroke="black"></path>
                <path d="M 328,144 L 408,144" fill="none" stroke="black"></path>
                <path d="M 8,176 L 424,176" fill="none" stroke="black"></path>
                <path d="M 160,256 L 320,256" fill="none" stroke="black"></path>
                <path d="M 8,272 L 424,272" fill="none" stroke="black"></path>
                <path d="M 40,320 L 192,320" fill="none" stroke="black"></path>
                <path d="M 320,320 L 408,320" fill="none" stroke="black"></path>
                <path d="M 192,352 L 320,352" fill="none" stroke="black"></path>
                <path d="M 40,384 L 192,384" fill="none" stroke="black"></path>
                <path d="M 40,448 L 112,448" fill="none" stroke="black"></path>
                <path d="M 128,448 L 224,448" fill="none" stroke="black"></path>
                <path d="M 320,464 L 408,464" fill="none" stroke="black"></path>
                <path d="M 40,512 L 224,512" fill="none" stroke="black"></path>
                <path d="M 8,528 L 424,528" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="328,352 316,346.4 316,357.6" fill="black" transform="rotate(0,320,352)"></polygon>
                <polygon class="arrowhead" points="328,144 316,138.4 316,149.6" fill="black" transform="rotate(270,320,144)"></polygon>
                <polygon class="arrowhead" points="128,448 116,442.4 116,453.6" fill="black" transform="rotate(90,120,448)"></polygon>
                <polygon class="arrowhead" points="128,144 116,138.4 116,149.6" fill="black" transform="rotate(270,120,144)"></polygon>
                <g class="text">
                  <text x="212" y="52">External</text>
                  <text x="304" y="52">Authorization</text>
                  <text x="388" y="52">Domain</text>
                  <text x="88" y="116">Authorization</text>
                  <text x="172" y="116">Server</text>
                  <text x="280" y="116">Protected</text>
                  <text x="356" y="116">Resource</text>
                  <text x="48" y="228">B1)</text>
                  <text x="96" y="228">present</text>
                  <text x="168" y="228">assertion</text>
                  <text x="296" y="228">B2)</text>
                  <text x="340" y="228">access</text>
                  <text x="392" y="292">Cloud</text>
                  <text x="220" y="324">1)</text>
                  <text x="248" y="324">get</text>
                  <text x="268" y="340">identity</text>
                  <text x="92" y="356">Workload</text>
                  <text x="364" y="356">Instance</text>
                  <text x="364" y="388">Metadata</text>
                  <text x="96" y="420">A1)</text>
                  <text x="140" y="420">access</text>
                  <text x="364" y="420">Service/</text>
                  <text x="364" y="436">Endpoint</text>
                  <text x="96" y="484">Protected</text>
                  <text x="172" y="484">Resource</text>
                </g>
              </svg><a href="#section-3.3-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-oauth2-assertion-flow-in-a-c" class="selfRef">OAuth2 Assertion Flow in a cloud environment</a>
          </figcaption></figure>
</div>
<p id="section-3.3-6">The steps shown in <a href="#fig-cloud" class="auto internal xref">Figure 5</a> are:<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-7.1">
            <p id="section-3.3-7.1.1">1) The workload retrieves identity from the Instance Metadata Endpoint.<a href="#section-3.3-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-8">In case the workload needs to access a resource within the cloud (protected by the same authorization server that issued the workload identity)<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-9.1">
            <p id="section-3.3-9.1.1">A1) The workload directly access the protected resource with the credential issued in step 1.<a href="#section-3.3-9.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-10">In case the workload needs to access a resource outside of the cloud (protected by a different authorization server). This can also be the same cloud but different context (tenant, account).<a href="#section-3.3-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-11.1">
            <p id="section-3.3-11.1.1">B1) The workload presents cloud-issued credential as an assertion towards the external authorization server using <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>. An access token is returned to the workload.<a href="#section-3.3-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-11.2">
            <p id="section-3.3-11.2.1">B2) Using the access token from step B1, the workload is able to access the protected resource in the external authorization domain.<a href="#section-3.3-11.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="cicd">
<section id="section-3.4">
        <h3 id="name-continues-integration-deplo">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-continues-integration-deplo" class="section-name selfRef">Continues integration/deployment systems</a>
        </h3>
<p id="section-3.4-1">Continous integration and deployment systems allow their pipelines/workflows to receive identity every time they run. Particularly in situations where build outputs need to be uploaded to resources protected by other authorization server, deployments need to be made, or more generally, protected resources to be accessed, <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span> is used to federate the pipeline/workflow identity to an identity of the other authorization server.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<span id="name-oauth2-assertion-flow-in-a-co"></span><div id="fig-cicd">
<figure id="figure-6">
          <div id="section-3.4-2.1">
            <div class="alignLeft art-svg artwork" id="section-3.4-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="416" width="488" viewBox="0 0 488 416" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,176" fill="none" stroke="black"></path>
                <path d="M 8,240 L 8,272" fill="none" stroke="black"></path>
                <path d="M 8,336 L 8,400" fill="none" stroke="black"></path>
                <path d="M 24,80 L 24,144" fill="none" stroke="black"></path>
                <path d="M 80,272 L 80,288" fill="none" stroke="black"></path>
                <path d="M 80,320 L 80,336" fill="none" stroke="black"></path>
                <path d="M 120,144 L 120,192" fill="none" stroke="black"></path>
                <path d="M 120,224 L 120,240" fill="none" stroke="black"></path>
                <path d="M 240,80 L 240,144" fill="none" stroke="black"></path>
                <path d="M 288,80 L 288,144" fill="none" stroke="black"></path>
                <path d="M 304,272 L 304,288" fill="none" stroke="black"></path>
                <path d="M 304,320 L 304,336" fill="none" stroke="black"></path>
                <path d="M 392,144 L 392,192" fill="none" stroke="black"></path>
                <path d="M 392,224 L 392,240" fill="none" stroke="black"></path>
                <path d="M 464,80 L 464,144" fill="none" stroke="black"></path>
                <path d="M 480,32 L 480,176" fill="none" stroke="black"></path>
                <path d="M 480,240 L 480,272" fill="none" stroke="black"></path>
                <path d="M 480,336 L 480,400" fill="none" stroke="black"></path>
                <path d="M 8,32 L 480,32" fill="none" stroke="black"></path>
                <path d="M 24,80 L 240,80" fill="none" stroke="black"></path>
                <path d="M 288,80 L 464,80" fill="none" stroke="black"></path>
                <path d="M 24,144 L 112,144" fill="none" stroke="black"></path>
                <path d="M 128,144 L 240,144" fill="none" stroke="black"></path>
                <path d="M 288,144 L 384,144" fill="none" stroke="black"></path>
                <path d="M 400,144 L 464,144" fill="none" stroke="black"></path>
                <path d="M 8,176 L 480,176" fill="none" stroke="black"></path>
                <path d="M 8,240 L 480,240" fill="none" stroke="black"></path>
                <path d="M 8,272 L 72,272" fill="none" stroke="black"></path>
                <path d="M 88,272 L 480,272" fill="none" stroke="black"></path>
                <path d="M 8,336 L 296,336" fill="none" stroke="black"></path>
                <path d="M 312,336 L 480,336" fill="none" stroke="black"></path>
                <path d="M 8,400 L 480,400" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="400,144 388,138.4 388,149.6" fill="black" transform="rotate(270,392,144)"></polygon>
                <polygon class="arrowhead" points="312,336 300,330.4 300,341.6" fill="black" transform="rotate(90,304,336)"></polygon>
                <polygon class="arrowhead" points="128,144 116,138.4 116,149.6" fill="black" transform="rotate(270,120,144)"></polygon>
                <polygon class="arrowhead" points="88,272 76,266.4 76,277.6" fill="black" transform="rotate(270,80,272)"></polygon>
                <g class="text">
                  <text x="268" y="52">External</text>
                  <text x="360" y="52">Authorization</text>
                  <text x="444" y="52">Domain</text>
                  <text x="104" y="116">Authorization</text>
                  <text x="188" y="116">Server</text>
                  <text x="344" y="116">Protected</text>
                  <text x="420" y="116">Resource</text>
                  <text x="52" y="212">3)</text>
                  <text x="96" y="212">present</text>
                  <text x="168" y="212">assertion</text>
                  <text x="356" y="212">4)</text>
                  <text x="396" y="212">access</text>
                  <text x="188" y="260">Task</text>
                  <text x="252" y="260">(Workload)</text>
                  <text x="72" y="308">1)schedules</text>
                  <text x="284" y="308">2)retrieve</text>
                  <text x="364" y="308">identity</text>
                  <text x="108" y="372">Continuous</text>
                  <text x="200" y="372">Integration</text>
                  <text x="256" y="372">/</text>
                  <text x="308" y="372">Deployment</text>
                  <text x="388" y="372">Platform</text>
                </g>
              </svg><a href="#section-3.4-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-oauth2-assertion-flow-in-a-co" class="selfRef">OAuth2 Assertion Flow in a continous integration/deployment environment</a>
          </figcaption></figure>
</div>
<p id="section-3.4-3">The steps shown in <a href="#fig-cicd" class="auto internal xref">Figure 6</a> are:<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-4.1">
            <p id="section-3.4-4.1.1">1) The continuous integration / deployment platform (CI-CD platform) schedules a task (considered a workload) to be performed.<a href="#section-3.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.2">
            <p id="section-3.4-4.2.1">2) The workload is able to retrieve identity from the CI-CD platform. This can differ based on the platform and potentially is already supplied during scheduling phase in step 1.<a href="#section-3.4-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.3">
            <p id="section-3.4-4.3.1">3) The workload presents the CI-CD issued credential as an assertion towards the authorization server in the external authorization domain based on <span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span>. In case of JWT also <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>. The authorization server returns an access token to the workload.<a href="#section-3.4-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.4">
            <p id="section-3.4-4.4.1">4) Using the access token from step 3, the workload is able to access the protected resource in the external authorization domain.<a href="#section-3.4-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-5">Tokens of different providers look different, but all of them contain claims carrying the basic context of the executed tasks such as source code management data (e.g. git branch), initiation and more.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">This entire document is about security.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document does not require actions by IANA.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="section-6">
      <h2 id="name-acknowledgements">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-6-1">Add your name here.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7521">[RFC7521]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Mortimore, C.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">Y. Goland</span>, <span class="refTitle">"Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7521</span>, <span class="seriesInfo">DOI 10.17487/RFC7521</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7521">https://www.rfc-editor.org/rfc/rfc7521</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7523">[RFC7523]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Campbell, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7523</span>, <span class="seriesInfo">DOI 10.17487/RFC7523</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7523">https://www.rfc-editor.org/rfc/rfc7523</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8414">https://www.rfc-editor.org/rfc/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="KubernetesServiceAccount">[KubernetesServiceAccount]</dt>
        <dd>
<span class="refTitle">"Kubernetes Service Account"</span>, <time datetime="2024-05" class="refDate">May 2024</time>, <span>&lt;<a href="https://kubernetes.io/docs/concepts/security/service-accounts/">https://kubernetes.io/docs/concepts/security/service-accounts/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OIDC">[OIDC]</dt>
        <dd>
<span class="refAuthor">Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0 incorporating errata set 1"</span>, <time datetime="2014-11" class="refDate">November 2014</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TokenRequestV1">[TokenRequestV1]</dt>
        <dd>
<span class="refTitle">"Kubernetes Token Request API V1"</span>, <time datetime="2024-08" class="refDate">August 2024</time>, <span>&lt;<a href="https://kubernetes.io/docs/reference/kubernetes-api/authentication-resources/token-request-v1/">https://kubernetes.io/docs/reference/kubernetes-api/authentication-resources/token-request-v1/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TokenReviewV1">[TokenReviewV1]</dt>
      <dd>
<span class="refTitle">"Kubernetes Token Review API V1"</span>, <time datetime="2024-08" class="refDate">August 2024</time>, <span>&lt;<a href="https://kubernetes.io/docs/reference/kubernetes-api/authentication-resources/token-review-v1/">https://kubernetes.io/docs/reference/kubernetes-api/authentication-resources/token-review-v1/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Benedikt Hofmann</span></div>
<div dir="auto" class="left"><span class="org">Siemens</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hofmann.benedikt@siemens.com" class="email">hofmann.benedikt@siemens.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="org">Siemens</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@gmx.net" class="email">hannes.tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Edoardo Giordano</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:edoardo.giordano@nokia.com" class="email">edoardo.giordano@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yaroslav Rosomakho</span></div>
<div dir="auto" class="left"><span class="org">Zscaler</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:yrosomakho@zscaler.com" class="email">yrosomakho@zscaler.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Arndt Schwenkschuster</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:arndts.ietf@gmail.com" class="email">arndts.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
